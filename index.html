<html>
<head>
	<title>The Dark Knight Rises</title>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js" type="text/javascript"></script>
 	  <link href="css/bootstrap.css" rel="stylesheet">
 			
<style type="text/css">

body
{
	background-color:#000000;
	margin:0;
	font-family:Arial;
}

a
{
	text-decoration:none;
}

#background
{
	background-image:url(images/p1.jpg);
	width:100%;
	height:100%;
}
	
#pane
{
	background-color:#000000;
	position:absolute;	
	left:20px;
	top:100px;
	padding:20px;
	color:white;
	opacity:0.90;
}

h1
{
	font-size:36px;	
}

h2
{
	font-size:22px;
}

h3
{
	font-size:108px;
	margin:0px;
}

h4
{
	font-size:28px;
}

#pane_time
{
	margin-top:40px;
	overflow:auto;
}

#pane_time div
{
	margin-left:30px;
	float:left;
}

.counter_holder *
{
	margin:0px;
}

#dialogue
{
	margin-top:35px;
	margin-bottom:20px;	
	overflow:auto;
	font-size:16px;
	max-width:700px;
}

#footer
{
	overflow:auto;	
}

#footer div
{
	float:left;
	margin-right:5px;
}

ul
{
	list-style-type:none;
	padding:0;
	overflow:auto;
}

ul li
{
	float:left;
	margin-right:10px;
}

#controls div
{
	cursor:pointer;
}

</style>

<script type="text/javascript">
	var image_counter = 0;
 	var preloaded = [];
	
	var images =
	{
		"p1.jpg" : "It's not who I am underneath but what I do that defines me.",
		"p2.jpg" : "Your punishment must be more severe.",
		"p3.jpg" : "When Gotham is in ashes, you have my permission to die.",
		"p4.jpg" : "Now's not the time to fear. That comes later.",
		"p5.jpg" : "There's a storm coming, Mr. Wayne.",
		"p6.jpg" : "I am Gotham's reckoning.",
		"p7.jpg" : "Now you're just showing off."
	};
 	
	var total_images = Object.keys(images).length;

	$(document).ready(function(){
		init_clock();
		init_controls();

		var preloaded_counter = 0;

		for(var key in images)
		{
			var img = new Image();
			preloaded.push(img);
			img.src = "images/" + key;
		
			img.onload = function()
			{
				preloaded_counter+=1;
				
				// All images have been cached
				if(preloaded_counter == total_images)
				{
					init_animation();
				}		
		}	}
	});

	function init_animation()
	{
		setInterval(function(){
			
			// fade out background
			$("#background").fadeOut(1000,
			function() { 
				//change image			
				image_counter = (image_counter + 1)%total_images;
			this.style.backgroundImage = "url(" + preloaded[image_counter].src + ")";
				//change dialogue
				$("#dialogue")[0].innerHTML = images[Object.keys(images)[image_counter]];
			
				//fade In
				$("#background").fadeIn(1000);
			});

		}, 5000);
	}
	
	function init_clock()
	{
		var release_date = new Date(2012, 6, 20);

		setInterval(function()
		{
			var today = new Date();
			
			var diff = release_date - today;
			var days = Math.floor(diff/(1000*60*60*24));
			today.setDate(release_date.getDate() - 1);
			today.setMonth(release_date.getMonth());

			diff = release_date - today;
			var hours = Math.floor(diff/(1000*60*60));
			today.setHours(today.getHours() + hours);	

			diff = release_date - today;
			var minutes = Math.floor(diff/(1000*60))
			today.setMinutes(today.getMinutes() + minutes)

			diff = release_date - today;
			var seconds = Math.floor(diff/(1000));		

			$("#days")[0].innerHTML = formatNum(days)
			$("#hours")[0].innerHTML = formatNum(hours);
			$("#minutes")[0].innerHTML = formatNum(minutes);
			$("#seconds")[0].innerHTML = formatNum(seconds);
		}, 1000);		

	}

	function formatNum(num)
	{
		return (num < 10 ? "0" + num : num);
	}
	
	function init_controls()
	{
		var paused = false;

		$("#pane").draggable();
		$("#pane").draggable("disable");
	
		$("#dragger").mousedown(function(){
			$("#pane").draggable("enable");
		}).mouseup(function() {
			$("#pane").draggable("disable");
		});

		$("#pause").click(function()
		{
		 	if(paused)	
			{
				$("audio")[0].play();
				this.style.opacity = 1;
			}
			else
			{
				$("audio")[0].pause();
				this.style.opacity = 0.4;
			}
			paused = ~paused;
		});
	}

</script>

</head>



<body>

<audio id="audio" autoplay="autoplay" preload="none">
	<source src="audio/beware2.mp3" type="audio/mpeg" preload="none" />
</audio>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "http://connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
	
<div id="background"></div>
	<div id="pane">
		<div id="pane_header" style="clear:both;">
			<h1 style="display:inline;">The Legend Ends</h1>
			<div id="controls" style="float:right">
				<ul>
				<li>
					<div id="pause"><img src="images/audio.png" width="20px;" height="20px;" /></div></li>
				<li>
					<div id="dragger"><img src="images/drag.png" width="20px" height="20px" /></div></li>
			
				</ul>
			</div>

		</div>
		<h2>20<sup>th</sup> July 2012</h2>
		<div id="pane_time">
			<div class="counter_holder" style="margin-left:0px;margin-right:40px;">
				<h3 id="days">--</h3> <h4>days</h4>
			</div>

			<div class="counter_holder">
				<h3 id="hours">--</h3><h4>hours</h4>
			</div>
	
			<div class="counter_holder">
				<h3>:</h3>
			</div>
	
			<div class="counter_holder">
				<h3 id="minutes">--</h3>
				<h4>minutes</h4>
			</div>

			<div class="counter_holder">
				<h3>:</h3>
			</div>

			<div class="counter_holder">
				<h3 id="seconds">--</h3>
				<h4>seconds</h4>
			</div>	
		</div>

		<div id="dialogue">It's not who I am underneath but what I do that defines me.</div>
		<hr />

		<div id="footer">
			
			<!-- Facebook Like -->
			<ul>
			<li>
			<div class="fb-like" data-href="http://www.google.com" data-layout="button_count" data-show-faces="true"></div>
			</li>

			<!--Twitter Tweet -->
			<li><a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="http://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></li>
		
		<!--Pin It button -->
		<li>
			<a target="_blank" href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.google.com&media=http%3A%2F%2Fwww.google.com%2F&description=The%20Dark%20Knight%20Rises%20-%20The%20Legend%20Ends%20Countdown." class="pin-it-button" count-layout="horizontal"><img border="0" src="http://assets.pinterest.com/images/PinExt.png" title="Pin It" /></a>
		<script type="text/javascript" src="http://assets.pinterest.com/js/pinit.js"></script>	

		</li>
		<li>
			<a class="btn btn-primary btn-small" height="20" href="http://www.facebook.com/vikeshkhanna" target="_blank">Stalk me!</a>
		</li>

		</ul>
	</div>

</body>
</html>

